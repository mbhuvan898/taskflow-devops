{"ast":null,"code":"import axios from 'axios';\n\n// CRA \"proxy\" in package.json forwards /api → http://localhost:5000\n// so we just use relative paths — no CORS issues in dev\nconst api = axios.create({\n  baseURL: '/api',\n  timeout: 30000\n});\napi.interceptors.request.use(cfg => {\n  const t = localStorage.getItem('tf_token');\n  if (t) cfg.headers.Authorization = `Bearer ${t}`;\n  return cfg;\n});\napi.interceptors.response.use(r => r, e => {\n  var _e$response;\n  if (((_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status) === 401 && window.location.pathname !== '/login') {\n    localStorage.removeItem('tf_token');\n    window.location.href = '/login';\n  }\n  return Promise.reject(e);\n});\n\n/* ── helpers ──────────────────────────────────────── */\nfunction fd(data) {\n  const f = new FormData();\n  Object.entries(data).forEach(([k, v]) => {\n    if (v == null) return;\n    if (k === 'file' && v instanceof File) f.append('file', v);else if (Array.isArray(v)) f.append(k, JSON.stringify(v));else f.append(k, String(v));\n  });\n  return f;\n}\n\n/* ── Auth ─────────────────────────────────────────── */\nexport const authAPI = {\n  register: d => api.post('/auth/register', d),\n  login: d => api.post('/auth/login', d),\n  me: () => api.get('/auth/me'),\n  uploadAvatar: f => {\n    const form = new FormData();\n    form.append('avatar', f);\n    return api.post('/auth/avatar', form);\n  }\n};\n\n/* ── Todos ────────────────────────────────────────── */\nexport const todosAPI = {\n  list: p => api.get('/todos', {\n    params: p\n  }),\n  get: id => api.get(`/todos/${id}`),\n  create: d => api.post('/todos', fd(d)),\n  update: (id, d) => api.put(`/todos/${id}`, fd(d)),\n  toggle: id => api.patch(`/todos/${id}/toggle`),\n  remove: id => api.delete(`/todos/${id}`),\n  removeFile: id => api.delete(`/todos/${id}/file`)\n};\n\n/* ── Categories ───────────────────────────────────── */\nexport const catsAPI = {\n  list: () => api.get('/categories'),\n  create: d => api.post('/categories', d),\n  update: (id, d) => api.put(`/categories/${id}`, d),\n  remove: id => api.delete(`/categories/${id}`)\n};\n\n/* ── Analytics ────────────────────────────────────── */\nexport const analyticsAPI = {\n  dashboard: () => api.get('/analytics/dashboard')\n};\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","timeout","interceptors","request","use","cfg","t","localStorage","getItem","headers","Authorization","response","r","e","_e$response","status","window","location","pathname","removeItem","href","Promise","reject","fd","data","f","FormData","Object","entries","forEach","k","v","File","append","Array","isArray","JSON","stringify","String","authAPI","register","d","post","login","me","get","uploadAvatar","form","todosAPI","list","p","params","id","update","put","toggle","patch","remove","delete","removeFile","catsAPI","analyticsAPI","dashboard"],"sources":["C:/Users/tast/Downloads/taskflow/client/src/utils/api.js"],"sourcesContent":["import axios from 'axios';\n\n// CRA \"proxy\" in package.json forwards /api → http://localhost:5000\n// so we just use relative paths — no CORS issues in dev\nconst api = axios.create({ baseURL: '/api', timeout: 30000 });\n\napi.interceptors.request.use((cfg) => {\n  const t = localStorage.getItem('tf_token');\n  if (t) cfg.headers.Authorization = `Bearer ${t}`;\n  return cfg;\n});\n\napi.interceptors.response.use(\n  (r) => r,\n  (e) => {\n    if (e.response?.status === 401 && window.location.pathname !== '/login') {\n      localStorage.removeItem('tf_token');\n      window.location.href = '/login';\n    }\n    return Promise.reject(e);\n  }\n);\n\n/* ── helpers ──────────────────────────────────────── */\nfunction fd(data) {\n  const f = new FormData();\n  Object.entries(data).forEach(([k, v]) => {\n    if (v == null) return;\n    if (k === 'file' && v instanceof File) f.append('file', v);\n    else if (Array.isArray(v)) f.append(k, JSON.stringify(v));\n    else f.append(k, String(v));\n  });\n  return f;\n}\n\n/* ── Auth ─────────────────────────────────────────── */\nexport const authAPI = {\n  register:     (d)  => api.post('/auth/register', d),\n  login:        (d)  => api.post('/auth/login', d),\n  me:           ()   => api.get('/auth/me'),\n  uploadAvatar: (f)  => { const form = new FormData(); form.append('avatar', f); return api.post('/auth/avatar', form); },\n};\n\n/* ── Todos ────────────────────────────────────────── */\nexport const todosAPI = {\n  list:       (p)     => api.get('/todos', { params: p }),\n  get:        (id)    => api.get(`/todos/${id}`),\n  create:     (d)     => api.post('/todos', fd(d)),\n  update:     (id, d) => api.put(`/todos/${id}`, fd(d)),\n  toggle:     (id)    => api.patch(`/todos/${id}/toggle`),\n  remove:     (id)    => api.delete(`/todos/${id}`),\n  removeFile: (id)    => api.delete(`/todos/${id}/file`),\n};\n\n/* ── Categories ───────────────────────────────────── */\nexport const catsAPI = {\n  list:   ()         => api.get('/categories'),\n  create: (d)        => api.post('/categories', d),\n  update: (id, d)    => api.put(`/categories/${id}`, d),\n  remove: (id)       => api.delete(`/categories/${id}`),\n};\n\n/* ── Analytics ────────────────────────────────────── */\nexport const analyticsAPI = {\n  dashboard: () => api.get('/analytics/dashboard'),\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}